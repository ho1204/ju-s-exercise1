<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>득근 캘린더</title>
    <!-- Tailwind CSS 불러오기 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM 불러오기 -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Babel (JSX 변환용) 불러오기 -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        /* 애니메이션 효과 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- 아이콘 컴포넌트 (Lucide 대체용 인라인 SVG) ---
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Calendar = (props) => (
            <IconBase {...props}>
                <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                <line x1="16" x2="16" y1="2" y2="6" />
                <line x1="8" x2="8" y1="2" y2="6" />
                <line x1="3" x2="21" y1="10" y2="10" />
            </IconBase>
        );

        const Clock = (props) => (
            <IconBase {...props}>
                <circle cx="12" cy="12" r="10" />
                <polyline points="12 6 12 12 16 14" />
            </IconBase>
        );

        const Dumbbell = (props) => (
            <IconBase {...props}>
                <path d="M6.5 6.5h11" />
                <path d="M6.5 17.5h11" />
                <path d="m2 21 20-20" />
                <path d="M5 5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2" />
                <path d="M19 5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2" />
            </IconBase>
        );

        const Plus = (props) => (
            <IconBase {...props}>
                <path d="M5 12h14" />
                <path d="M12 5v14" />
            </IconBase>
        );

        const Trash2 = (props) => (
            <IconBase {...props}>
                <path d="M3 6h18" />
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                <line x1="10" x2="10" y1="11" y2="17" />
                <line x1="14" x2="14" y1="11" y2="17" />
            </IconBase>
        );

        const Activity = (props) => (
            <IconBase {...props}>
                <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
            </IconBase>
        );

        const CheckCircle2 = (props) => (
            <IconBase {...props}>
                <circle cx="12" cy="12" r="10" />
                <path d="m9 12 2 2 4-4" />
            </IconBase>
        );

        const ChevronRight = (props) => (
            <IconBase {...props}>
                <path d="m9 18 6-6-6-6" />
            </IconBase>
        );

        // --- 메인 App 컴포넌트 ---
        const App = () => {
            // 상태 관리
            const [workouts, setWorkouts] = useState([]);
            const [date, setDate] = useState('');
            const [duration, setDuration] = useState(30);
            const [selectedParts, setSelectedParts] = useState([]);
            const [selectedDetails, setSelectedDetails] = useState([]); // 세부 운동 항목 상태

            // 운동 부위 목록
            const BODY_PARTS = ['등', '어깨', '팔', '허벅지', '엉덩이'];
            
            // '등' 선택 시 나오는 세부 운동 목록
            const BACK_EXERCISES = [
                '사이드 레터럴 레이즈', 
                '불가리안 스플릿 스쿼드', 
                '풀오버', 
                '바벨로우', 
                '데드리프트'
            ];
            
            // 운동 시간 옵션 (30분 ~ 180분)
            const DURATION_OPTIONS = [30, 60, 90, 120, 150, 180];

            // 초기 로드 시 로컬 스토리지에서 데이터 불러오기
            useEffect(() => {
                const savedWorkouts = localStorage.getItem('myWorkouts');
                if (savedWorkouts) {
                    setWorkouts(JSON.parse(savedWorkouts));
                }
                // 오늘 날짜로 초기화
                const today = new Date().toISOString().split('T')[0];
                setDate(today);
            }, []);

            // 데이터 변경 시 로컬 스토리지에 저장
            useEffect(() => {
                localStorage.setItem('myWorkouts', JSON.stringify(workouts));
            }, [workouts]);

            // 운동 부위 선택 토글 함수
            const toggleBodyPart = (part) => {
                if (selectedParts.includes(part)) {
                    const newParts = selectedParts.filter(p => p !== part);
                    setSelectedParts(newParts);
                    // '등'을 해제하면 관련 세부 항목도 초기화
                    if (part === '등') {
                        setSelectedDetails([]);
                    }
                } else {
                    setSelectedParts([...selectedParts, part]);
                }
            };

            // 세부 운동 선택 토글 함수
            const toggleDetail = (exercise) => {
                if (selectedDetails.includes(exercise)) {
                    setSelectedDetails(selectedDetails.filter(e => e !== exercise));
                } else {
                    setSelectedDetails([...selectedDetails, exercise]);
                }
            };

            // 기록 추가 함수
            const handleSubmit = (e) => {
                e.preventDefault();
                if (selectedParts.length === 0) {
                    alert("최소 한 개의 운동 부위를 선택해주세요.");
                    return;
                }

                const newWorkout = {
                    id: Date.now(),
                    date,
                    duration,
                    parts: selectedParts,
                    details: selectedDetails, // 세부 항목 저장
                    createdAt: new Date().toISOString()
                };

                setWorkouts([newWorkout, ...workouts]); // 최신순 정렬
                
                // 입력 폼 초기화 (날짜는 유지)
                setSelectedParts([]);
                setSelectedDetails([]);
                setDuration(30);
            };

            // 기록 삭제 함수
            const deleteWorkout = (id) => {
                if (window.confirm('이 기록을 삭제하시겠습니까?')) {
                    setWorkouts(workouts.filter(w => w.id !== id));
                }
            };

            // 시간 포맷팅 (분 -> 시간 분)
            const formatDuration = (mins) => {
                const hours = Math.floor(mins / 60);
                const minutes = mins % 60;
                if (hours > 0 && minutes > 0) return `${hours}시간 ${minutes}분`;
                if (hours > 0) return `${hours}시간`;
                return `${minutes}분`;
            };

            // 총 누적 통계 계산
            const totalSessions = workouts.length;
            const totalMinutes = workouts.reduce((acc, curr) => acc + parseInt(curr.duration), 0);

            return (
                <div className="min-h-screen bg-gray-50 text-gray-800 font-sans p-4 md:p-8">
                    <div className="max-w-md mx-auto space-y-6">
                        
                        {/* 헤더 */}
                        <div className="text-center space-y-2 mb-8">
                            <div className="flex justify-center items-center gap-2 text-indigo-600">
                                <Dumbbell size={32} />
                                <h1 className="text-3xl font-bold tracking-tight">득근 캘린더</h1>
                            </div>
                            <p className="text-gray-500 text-sm">오늘도 꾸준히, 건강한 습관 만들기</p>
                        </div>

                        {/* 통계 요약 카드 */}
                        <div className="bg-white rounded-2xl shadow-sm border border-indigo-100 p-5 flex justify-around items-center">
                            <div className="text-center">
                                <p className="text-xs text-gray-400 mb-1 uppercase tracking-wider font-semibold">총 운동 횟수</p>
                                <p className="text-2xl font-bold text-indigo-600">{totalSessions}회</p>
                            </div>
                            <div className="h-10 w-px bg-gray-100"></div>
                            <div className="text-center">
                                <p className="text-xs text-gray-400 mb-1 uppercase tracking-wider font-semibold">총 운동 시간</p>
                                <p className="text-2xl font-bold text-indigo-600">{formatDuration(totalMinutes)}</p>
                            </div>
                        </div>

                        {/* 입력 폼 */}
                        <form onSubmit={handleSubmit} className="bg-white rounded-2xl shadow-lg p-6 space-y-6 border border-gray-100">
                        
                            {/* 날짜 선택 - 크기 확대 */}
                            <div className="space-y-2">
                                <label className="flex items-center gap-2 text-sm font-semibold text-gray-700">
                                    <Calendar size={16} className="text-indigo-500" />
                                    날짜
                                </label>
                                <input
                                    type="date"
                                    required
                                    value={date}
                                    onChange={(e) => setDate(e.target.value)}
                                    className="w-full p-4 text-lg bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all cursor-pointer"
                                />
                            </div>

                            {/* 운동 시간 선택 */}
                            <div className="space-y-2">
                                <label className="flex items-center gap-2 text-sm font-semibold text-gray-700">
                                    <Clock size={16} className="text-indigo-500" />
                                    운동 시간
                                </label>
                                <div className="grid grid-cols-3 gap-2">
                                    {DURATION_OPTIONS.map((time) => (
                                        <button
                                            key={time}
                                            type="button"
                                            onClick={() => setDuration(time)}
                                            className={`py-3 px-1 text-sm rounded-xl border transition-all ${
                                                duration === time
                                                ? 'bg-indigo-50 border-indigo-500 text-indigo-700 font-bold'
                                                : 'bg-white border-gray-200 text-gray-600 hover:bg-gray-50'
                                            }`}
                                        >
                                            {formatDuration(time)}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* 운동 부위 선택 (다중) */}
                            <div className="space-y-3">
                                <label className="flex items-center gap-2 text-sm font-semibold text-gray-700">
                                    <Activity size={16} className="text-indigo-500" />
                                    운동 부위 (다중 선택)
                                </label>
                                <div className="flex flex-wrap gap-2">
                                    {BODY_PARTS.map((part) => (
                                        <button
                                            key={part}
                                            type="button"
                                            onClick={() => toggleBodyPart(part)}
                                            className={`py-2 px-4 rounded-full text-sm font-medium transition-all shadow-sm ${
                                                selectedParts.includes(part)
                                                ? 'bg-indigo-600 text-white shadow-indigo-200 transform scale-105'
                                                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                            }`}
                                        >
                                            {part}
                                        </button>
                                    ))}
                                </div>

                                {/* '등' 선택 시 나타나는 세부 항목 */}
                                {selectedParts.includes('등') && (
                                    <div className="mt-3 p-4 bg-gray-50 rounded-xl border border-gray-100 animate-fadeIn">
                                        <p className="text-xs font-bold text-gray-500 mb-2 ml-1">등 운동 세부 선택</p>
                                        <div className="flex flex-wrap gap-2">
                                            {BACK_EXERCISES.map((exercise) => (
                                                <button
                                                    key={exercise}
                                                    type="button"
                                                    onClick={() => toggleDetail(exercise)}
                                                    className={`py-1.5 px-3 rounded-lg text-xs transition-all border ${
                                                        selectedDetails.includes(exercise)
                                                        ? 'bg-indigo-100 border-indigo-200 text-indigo-700 font-bold'
                                                        : 'bg-white border-gray-200 text-gray-500 hover:bg-gray-100'
                                                    }`}
                                                >
                                                    {exercise}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* 저장 버튼 */}
                            <button
                                type="submit"
                                className="w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2 active:scale-95 text-lg"
                            >
                                <Plus size={22} />
                                기록 저장하기
                            </button>
                        </form>

                        {/* 기록 리스트 */}
                        <div className="space-y-4">
                            <h2 className="text-lg font-bold text-gray-800 px-1 flex items-center gap-2">
                                <CheckCircle2 size={20} className="text-green-500" />
                                최근 운동 기록
                            </h2>
                            
                            {workouts.length === 0 ? (
                                <div className="text-center py-10 bg-white rounded-2xl border border-dashed border-gray-300 text-gray-400">
                                    <Dumbbell className="mx-auto mb-2 opacity-20" size={48} />
                                    <p>아직 기록된 운동이 없습니다.<br/>첫 운동을 시작해보세요!</p>
                                </div>
                            ) : (
                                <div className="space-y-3 pb-8">
                                    {workouts.map((workout) => (
                                        <div key={workout.id} className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow relative group">
                                            
                                            {/* 날짜 헤더 */}
                                            <div className="flex justify-between items-center mb-2">
                                                <span className="text-sm font-bold text-gray-500 bg-gray-100 px-2 py-0.5 rounded">
                                                    {workout.date}
                                                </span>
                                                <button 
                                                    onClick={() => deleteWorkout(workout.id)}
                                                    className="text-gray-300 hover:text-red-500 p-2 rounded-full hover:bg-red-50 transition-colors"
                                                    aria-label="삭제"
                                                >
                                                    <Trash2 size={18} />
                                                </button>
                                            </div>

                                            {/* 메인 내용: 시간 및 부위 (글자 크게) */}
                                            <div className="flex flex-col gap-1 mb-2">
                                                <div className="flex items-baseline gap-2 flex-wrap">
                                                    <h3 className="text-2xl font-bold text-gray-800">
                                                        {formatDuration(workout.duration)}
                                                    </h3>
                                                    {/* 부위 표시 */}
                                                    <span className="text-lg font-semibold text-indigo-600">
                                                        — {workout.parts.join(', ')}
                                                    </span>
                                                </div>
                                            </div>
                                            
                                            {/* 세부 운동 항목 표시 */}
                                            {workout.details && workout.details.length > 0 && (
                                                <div className="mt-3 pt-3 border-t border-dashed border-gray-100">
                                                    <div className="flex flex-wrap gap-1.5">
                                                        {workout.details.map((detail, idx) => (
                                                            <span key={idx} className="bg-indigo-50 text-indigo-700 text-xs px-2.5 py-1 rounded-md font-medium flex items-center gap-1">
                                                                <ChevronRight size={10} />
                                                                {detail}
                                                            </span>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>